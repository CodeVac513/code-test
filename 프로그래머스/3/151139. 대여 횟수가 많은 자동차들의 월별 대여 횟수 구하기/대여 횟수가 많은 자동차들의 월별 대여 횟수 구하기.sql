SELECT CASE WHEN c.START_DATE BETWEEN DATE '2022-08-01' AND DATE '2022-08-31' THEN 8
            WHEN c.START_DATE BETWEEN DATE '2022-09-01' AND DATE '2022-09-30' THEN 9
            WHEN c.START_DATE BETWEEN DATE '2022-10-01' AND DATE '2022-10-31' THEN 10
       END AS MONTH, 
       c.CAR_ID, 
       COUNT(*) AS RECORDS
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY c
JOIN (SELECT CAR_ID
      FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
      WHERE START_DATE BETWEEN DATE '2022-08-01' AND DATE '2022-10-31'
      GROUP BY CAR_ID
      HAVING COUNT(*) >= 5) cg
     ON cg.CAR_ID = c.CAR_ID
WHERE c.START_DATE BETWEEN DATE '2022-08-01' AND DATE '2022-10-31'
GROUP BY CASE WHEN c.START_DATE BETWEEN DATE '2022-08-01' AND DATE '2022-08-31' THEN 8
              WHEN c.START_DATE BETWEEN DATE '2022-09-01' AND DATE '2022-09-30' THEN 9
              WHEN c.START_DATE BETWEEN DATE '2022-10-01' AND DATE '2022-10-31' THEN 10
         END, 
         c.CAR_ID
ORDER BY MONTH ASC, c.CAR_ID DESC;